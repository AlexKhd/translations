http://www.justinweiss.com/articles/finding-your-way-around-a-new-rails-project/

Как быстро разобраться в незнакомом Rails приложении

Представьте, что вы сменили команду или приступили к новой работе, задаче. Или же нашли баг в любимом open-source проекте и хотите отправить свой первый пулл-реквест. И сразу же потерялись, глядя на app/models после выполнения git clone. Бывает непросто понять код, даже несмотря на то, что структура данного приложения Rails та же самая, которую вы обычно используете. Как же быстрее всего начать работать с незнакомым приложением?

Создание словаря

Что такое Player, что такое Session? Как насчет выбора между Account, User и Provider?

В каждом приложении могут быть свои термины и определения. И, не понимая словаря, которое используется в приложении, вы будете терять время, разглядывая app/models каждый раз, когда вы встречаете новый класс. Или, что еще хуже, вы будете делать неверные предположения о работе функционала.

Итак, первым делом правильнее всего создать словарь. Узнать, из чего сделано данное приложение. Если хотите сделать это быстро, то изучите файл db/schema.rb. Вы узнаете о терминах, используемых в приложении, а также познакомитесь со структурой данных. Уделив внимание столбцам ID, вы поймете, как модели связаны между собой.

Если вы предпочитаете наглядность, то можно использовать гем rails-erd. На основании моделей он создаст диаграмму, отображающую столбцы, таблицы и их взаимодействие. Если вы положите распечатку на стол, то будет намного легче разбираться с остальной частью приложения.

Продолжаем с моделями и простыми объектами Ruby

В хорошо спроектированном приложении вы не найдете всей информации в файле схемы. Продолжая работу со словарем, посмотрите app/models на наличие дополнительных классов и атрибутов, которые отсутствуют в db/schema.rb.

Не задерживайтесь на этом этапе. Тут легко потеряться, выясняя как все это работает. Мы здесь сейчас только для составления словаря.

Начиная понимать из чего состоят части приложения, вы начнете задаваться вопросом о назначении определенных объектов, или почему они связаны именно таким образом. Сейчас мы разберем этот момент.

Запустите приложение, и выясните - почему именно так?

Хорошо изучив объекты, которое использует приложение, запустите его. Поработайте с ним. Если есть документация, то она может помочь. Как бы то ни было, вы увидите все, о чем вы только что узнали, вживую.

Работая с приложением, вы начнете его осваивать с верхнего уровня. Поймете причины, по которым модели связаны именно таким образом. Для чего они сгруппированы. Почему были выбраны именно эти названия классов. Может быть они отображаются на страницах совместно, а может располагаются на своих собственных формах.

И когда вы начнете понимать из чего состоят части приложения и для чего они существуют, вы будете готовы понять, как это все работает.

Как работает программа?

На данный момент вы знаете уже достаточно о приложении, чтобы углубиться в его детальное исследование. Вас не смутят новые термины и новые взаимодействия внутри его. Вы можете выбрать то, что вас интересует, и все про это узнать.

С этого момента у вас есть множество путей на выбор. Вот мои любимые:

    Посмотрите на пользовательский интерфейс программы и подумайте: как эта функциональность могла быть реализована, основываясь на имеющихся у вас знаниях о компонентах программы? Сможете ли вы угадать? С помощью отладчика подтвердите свою догадку, или же узнайте как это работает на самом деле.
    Выберите тест-кейс и пройдите по нему в приложении. Или пройдитесь по коду, или же исследуйте с помощью отладчика.
    Выберите маршрут или действие контроллера. Сможете ли вы понять, как вызвать это действие из пользовательского интерфейса?

Сейчас также подходящее время, чтобы вернуться к моделям и простым Ruby объектам. Теперь вы можете копнуть глубже и посмотреть как работают модели.

Покопайтесь в приложении. Найдите пробелы в своих знаниях и заполните их, используя отладчик и имеющийся код.

Почему бы не начать с тестов?

Я часто слышал фразу "Если хотите понять программу, начните с тестов! Это документация в исполняемом виде!"

Но для меня это никогда не работало. Тест-кейсы слишком узконаправлены, слишком детализированы. Если я учусь от тестов, то мне кажется, что я пропускаю что-то более глобальное в приложении.

Для того, чтобы понять большое приложение на Rails, или даже большинство гемов, я всегда сначала провожу общий обзор. Я должен знать, из каких компонентов состоит программа и для чего они созданы.

Но, вне всякого сомнения, необходимо запустить тесты. Если они проходят с ошибками, то вы работаете со сломанной программой. И вы не можете полагаться на информацию, полученную от такой системы.

Что, зачем и как

Чтобы понять незнакомую программу, выполните три шага в следующем порядке:

    Из каких частей состоит программа?
    Зачем они созданы? Почему они связаны вместе именно таким образом?
    Как работает каждая часть в отдельности?

Это позволит взглянуть на программу как в общем виде, так и в разрезе компонентов, что необходимо для понимания программы и успешной работы с ней.
